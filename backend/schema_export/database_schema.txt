Database Schema: MobileDetailHub
Exported: 2025-08-28T20:58:51.160Z
Total Tables: 17

=== ADDRESSES ===
Rows: 1

Columns:
  id: integer NOT NULL
  line1: character varying(255) NULL
  city: character varying(100) NULL
  state_code: character(2) NOT NULL
  postal_code: character varying(20) NULL
  lat: double precision NULL
  lng: double precision NULL
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: id

Sample Data:
  Row 1: {"id":1,"line1":"Bullhead City, AZ","city":"Bullhead City","state_code":"AZ","postal_code":"86442","lat":null,"lng":null,"created_at":"2025-08-28T20:37:28.505Z","updated_at":"2025-08-28T20:37:28.505Z"}


=== AFFILIATE_USERS ===
Rows: 0

Columns:
  id: integer NOT NULL
  affiliate_id: integer NOT NULL
  user_id: integer NOT NULL
  role: USER-DEFINED NOT NULL
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: id

Foreign Keys:
  affiliate_id -> affiliates.id
  user_id -> users.id


=== AFFILIATES ===
Rows: 1

Columns:
  id: integer NOT NULL
  slug: character varying(100) NOT NULL
  business_name: character varying(255) NOT NULL
  owner: character varying(255) NOT NULL
  phone: character varying(20) NOT NULL
  sms_phone: character varying(20) NULL
  email: USER-DEFINED NOT NULL
  base_address_id: integer NULL
  website_url: character varying(500) NULL
  gbp_url: character varying(500) NULL
  facebook_url: character varying(500) NULL
  instagram_url: character varying(500) NULL
  youtube_url: character varying(500) NULL
  tiktok_url: character varying(500) NULL
  application_status: USER-DEFINED NOT NULL DEFAULT 'pending'::affiliate_status
  has_insurance: boolean NULL DEFAULT false
  source: character varying(100) NULL
  notes: text NULL
  uploads: ARRAY NULL
  business_license: character varying(100) NULL
  insurance_provider: character varying(255) NULL
  insurance_expiry: date NULL
  service_radius_miles: integer NULL DEFAULT 25
  operating_hours: jsonb NULL
  emergency_contact: jsonb NULL
  total_jobs: integer NULL DEFAULT 0
  rating: numeric NULL
  review_count: integer NULL DEFAULT 0
  service_areas: jsonb NULL DEFAULT '[]'::jsonb
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()
  application_date: timestamp with time zone NOT NULL DEFAULT now()
  approved_date: timestamp with time zone NULL
  last_activity: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: id

Foreign Keys:
  base_address_id -> addresses.id

Sample Data:
  Row 1: {"id":2,"slug":"abc","business_name":"Test Mobile Detail Pro LLC","owner":"John Smith","phone":"5551234567","sms_phone":"+15551234567","email":"john@testmobiledetailpro.com","base_address_id":1,"website_url":"https://testmobiledetailpro.com","gbp_url":"https://g.page/test-mobile-detail-pro","facebook_url":"https://facebook.com/testmobiledetailpro","instagram_url":"https://instagram.com/testmobiledetailpro","youtube_url":"https://youtube.com/@testmobiledetailpro","tiktok_url":"https://tiktok.com/@testmobiledetailpro","application_status":"approved","has_insurance":true,"source":"Google Search","notes":"Test application for development and testing purposes. This is a sample affiliate application.\n\nAdmin Approval Notes: ","uploads":null,"business_license":null,"insurance_provider":null,"insurance_expiry":null,"service_radius_miles":25,"operating_hours":null,"emergency_contact":null,"total_jobs":0,"rating":null,"review_count":0,"service_areas":[{"zip":"86442","city":"Bullhead City","slug":"temp-1756414076343-jzmcykfbf","state":"AZ"}],"created_at":"2025-08-28T20:47:56.357Z","updated_at":"2025-08-28T20:48:07.222Z","application_date":"2025-08-28T20:47:56.357Z","approved_date":"2025-08-28T20:48:07.222Z","last_activity":"2025-08-28T20:47:56.357Z"}


=== AVAILABILITY ===
Rows: 0

Columns:
  id: integer NOT NULL
  affiliate_id: integer NOT NULL
  time_window: tstzrange NOT NULL
  capacity: integer NOT NULL DEFAULT 1
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: id

Foreign Keys:
  affiliate_id -> affiliates.id


=== BOOKINGS ===
Rows: 0

Columns:
  id: integer NOT NULL
  affiliate_id: integer NOT NULL
  customer_id: integer NULL
  service_id: integer NULL
  tier_id: integer NULL
  appointment_start: timestamp with time zone NOT NULL
  appointment_end: timestamp with time zone NOT NULL
  address_json: jsonb NOT NULL DEFAULT '{}'::jsonb
  status: USER-DEFINED NOT NULL DEFAULT 'pending'::booking_status
  total_cents: integer NOT NULL DEFAULT 0
  stripe_payment_intent_id: text NULL
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: id

Foreign Keys:
  affiliate_id -> affiliates.id
  customer_id -> customers.id
  service_id -> services.id
  tier_id -> service_tiers.id


=== CUSTOMERS ===
Rows: 0

Columns:
  id: integer NOT NULL
  user_id: integer NULL
  name: character varying(255) NOT NULL
  email: USER-DEFINED NULL
  phone: character varying(50) NULL
  address: character varying(255) NULL
  preferences: jsonb NULL
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: id

Foreign Keys:
  user_id -> users.id


=== LOCATION ===
Rows: 0

Columns:
  location_id: bigint NOT NULL
  affiliate_id: integer NULL
  source_platform: USER-DEFINED NOT NULL
  source_account_id: text NOT NULL
  source_location_id: text NOT NULL
  display_name: text NULL
  timezone: text NULL
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: location_id

Foreign Keys:
  affiliate_id -> affiliates.id


=== MDH_CONFIG ===
Rows: 1

Columns:
  id: integer NOT NULL
  email: character varying(255) NULL
  phone: character varying(50) NULL
  sms_phone: character varying(50) NULL
  logo_url: character varying(255) NULL
  favicon_url: character varying(255) NULL
  facebook: character varying(255) NULL
  instagram: character varying(255) NULL
  tiktok: character varying(255) NULL
  youtube: character varying(255) NULL
  header_display: character varying(255) NULL
  location: character varying(255) NULL
  name: character varying(255) NULL
  tagline: text NULL
  services_description: text NULL DEFAULT 'Auto, boat & RV detailing, paint correction, ceramic coating, and PPF'::text
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: id

Sample Data:
  Row 1: {"id":1,"email":"service@mobiledetailhub.com","phone":"(888) 555-1234","sms_phone":"+17024206066","logo_url":"/assets/logo.webp","favicon_url":"/assets/favicon.ico","facebook":"https://facebook.com/mobiledetailhub","instagram":"https://instagram.com/mobiledetailhub","tiktok":"https://tiktok.com/@mobiledetailhub","youtube":"https://youtube.com/mobiledetailhub","header_display":"Mobile Detail Hub","location":"Anywhere, USA","name":"Mobile Detail Hub","tagline":null,"services_description":"Auto, boat & RV detailing, paint correction, ceramic coating, and PPF","created_at":"2025-08-28T20:29:17.387Z","updated_at":"2025-08-28T20:29:17.387Z"}


=== QUOTES ===
Rows: 0

Columns:
  id: integer NOT NULL
  affiliate_id: integer NOT NULL
  customer_id: integer NULL
  address_json: jsonb NOT NULL DEFAULT '{}'::jsonb
  requested_start: timestamp with time zone NULL
  status: USER-DEFINED NOT NULL DEFAULT 'new'::quote_status
  details_json: jsonb NOT NULL DEFAULT '{}'::jsonb
  estimated_total_cents: integer NULL
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: id

Foreign Keys:
  affiliate_id -> affiliates.id
  customer_id -> customers.id


=== REFRESH_TOKENS ===
Rows: 1

Columns:
  id: integer NOT NULL
  user_id: integer NOT NULL
  token_hash: text NOT NULL
  user_agent: text NULL
  ip_address: inet NULL
  device_id: text NULL
  expires_at: timestamp with time zone NULL
  revoked_at: timestamp with time zone NULL
  is_revoked: boolean NULL DEFAULT false
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: id

Foreign Keys:
  user_id -> users.id

Sample Data:
  Row 1: {"id":1,"user_id":1,"token_hash":"0cda66e04e4f966ed66b37c0daa8a6081d4f4ce75e7d2c83564094afb5e19f2c","user_agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36","ip_address":"::1","device_id":"d0775dd38d37a7c8","expires_at":"2025-09-04T20:47:35.488Z","revoked_at":null,"is_revoked":false,"created_at":"2025-08-28T20:47:35.492Z","updated_at":"2025-08-28T20:47:35.492Z"}


=== REVIEW_REPLY ===
Rows: 0

Columns:
  id: bigint NOT NULL
  review_id: bigint NOT NULL
  text: text NULL
  reply_update_time: timestamp with time zone NULL
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: id

Foreign Keys:
  review_id -> reviews.id


=== REVIEW_SYNC_STATE ===
Rows: 0

Columns:
  location_id: bigint NOT NULL
  last_seen_update: timestamp with time zone NULL
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: location_id

Foreign Keys:
  location_id -> location.location_id


=== REVIEWS ===
Rows: 0

Columns:
  id: bigint NOT NULL
  external_id: text NULL
  affiliate_id: integer NOT NULL
  location_id: bigint NULL
  rating: smallint NULL
  text: text NULL
  author_name: text NULL
  author_profile_url: text NULL
  create_time: timestamp with time zone NULL
  update_time: timestamp with time zone NULL
  is_deleted: boolean NOT NULL DEFAULT false
  source_platform: USER-DEFINED NOT NULL
  raw: jsonb NULL
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: id

Foreign Keys:
  affiliate_id -> affiliates.id
  location_id -> location.location_id


=== SCHEMA_MIGRATIONS ===
Rows: 1

Columns:
  version: text NOT NULL
  applied_at: timestamp with time zone NULL DEFAULT now()
  description: text NULL

Primary Key: version

Sample Data:
  Row 1: {"version":"v4.1","applied_at":"2025-08-28T20:29:17.387Z","description":"Simplified service areas with JSONB; removed complex geography tables"}


=== SERVICE_TIERS ===
Rows: 0

Columns:
  id: integer NOT NULL
  service_id: integer NOT NULL
  name: character varying(100) NOT NULL
  price_delta_cents: integer NOT NULL DEFAULT 0
  description: text NULL
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: id

Foreign Keys:
  service_id -> services.id


=== SERVICES ===
Rows: 3

Columns:
  id: integer NOT NULL
  affiliate_id: integer NOT NULL
  category: USER-DEFINED NOT NULL
  name: character varying(200) NOT NULL
  description: text NULL
  base_price_cents: integer NOT NULL DEFAULT 0
  pricing_unit: USER-DEFINED NOT NULL DEFAULT 'flat'::pricing_unit
  min_duration_min: integer NOT NULL DEFAULT 60
  active: boolean NOT NULL DEFAULT true
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: id

Foreign Keys:
  affiliate_id -> affiliates.id

Sample Data:
  Row 1: {"id":4,"affiliate_id":2,"category":"auto","name":"Auto Detailing","description":"Auto Detailing service offered by Test Mobile Detail Pro LLC","base_price_cents":0,"pricing_unit":"flat","min_duration_min":60,"active":true,"created_at":"2025-08-28T20:47:56.364Z","updated_at":"2025-08-28T20:47:56.364Z"}
  Row 2: {"id":5,"affiliate_id":2,"category":"ceramic","name":"Ceramic Coating","description":"Ceramic Coating service offered by Test Mobile Detail Pro LLC","base_price_cents":0,"pricing_unit":"flat","min_duration_min":60,"active":true,"created_at":"2025-08-28T20:47:56.369Z","updated_at":"2025-08-28T20:47:56.369Z"}


=== USERS ===
Rows: 2

Columns:
  id: integer NOT NULL
  email: USER-DEFINED NOT NULL
  name: character varying(255) NULL
  role: USER-DEFINED NOT NULL
  is_admin: boolean NULL DEFAULT false
  password_hash: character varying(255) NULL
  phone: character varying(50) NULL
  created_at: timestamp with time zone NOT NULL DEFAULT now()
  updated_at: timestamp with time zone NOT NULL DEFAULT now()

Primary Key: id

Sample Data:
  Row 1: {"id":1,"email":"admin@mobiledetailhub.com","name":"Brandan Coleman","role":"admin","is_admin":true,"password_hash":"$2a$10$EAY3D9OdVXpYgby.ATOmheJwqrlTZ423Yg2a.qLzN1Ku1/oj2/LzS","phone":null,"created_at":"2025-08-28T20:29:17.387Z","updated_at":"2025-08-28T20:29:17.387Z"}
  Row 2: {"id":3,"email":"john@testmobiledetailpro.com","name":"John Smith","role":"affiliate","is_admin":false,"password_hash":"$2a$10$T.14FwW5DYMRfuL01CVhlugzsPmnAois5SViBsDrg.uo/b5UeU5QG","phone":"5551234567","created_at":"2025-08-28T20:48:07.286Z","updated_at":"2025-08-28T20:48:07.286Z"}


